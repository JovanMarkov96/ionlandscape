"use strict";(globalThis.webpackChunkionlandscape_site=globalThis.webpackChunkionlandscape_site||[]).push([[840],{8662(e,t,n){n.r(t),n.d(t,{default:()=>a});var s=n(6540),l=n(223),o=n(8774),r=n(6347),i=n(4848);const a=function(){const e=(0,r.zy)(),t=(0,r.W6)(),[n,a]=(0,s.useState)([]),c=new URLSearchParams(e.search),u=c.get("q")||"",d=c.getAll("label"),h=c.getAll("ion"),p=c.getAll("inst"),m=c.getAll("country"),[f,g]=(0,s.useState)(u),[y,x]=(0,s.useState)(c.get("category")||"All");(0,s.useEffect)(()=>{const e=document.getElementById("search-input");document.activeElement===e||u===f||g(u)},[u]),(0,s.useEffect)(()=>{const e=setTimeout(()=>{f!==u&&w({q:f,label:d,ion:h,inst:p,country:m,category:y},!0)},300);return()=>clearTimeout(e)},[f,d,h,p,m,y]);const v=e=>n.filter(t=>{if("All"!==y){const e=(t.platforms||[]).some(e=>e.toLowerCase().includes("neutral"));if("Neutral Atoms"===y&&!e)return!1;if("Trapped Ions"===y&&e)return!1}return!(e.inst&&e.inst.length>0&&!e.inst.includes(t.current_position?.institution))&&!(e.country&&e.country.length>0&&!e.country.includes(t.location?.country))}),b=(0,s.useMemo)(()=>{const e=v({country:m}),t=new Set;return e.forEach(e=>{e.current_position?.institution&&t.add(e.current_position.institution)}),Array.from(t).sort().filter(e=>!p.includes(e))},[n,y,m,p]),j=(0,s.useMemo)(()=>{const e=v({inst:p}),t=new Set;return e.forEach(e=>{e.location?.country&&t.add(e.location.country)}),Array.from(t).sort().filter(e=>!m.includes(e))},[n,y,p,m]),{availableLabels:N,availableIons:C}=(0,s.useMemo)(()=>{const e=v({}),t=new Set,n=new Set;return e.forEach(e=>{(e.labels||[]).forEach(e=>t.add(e)),(e.ion_species||[]).forEach(e=>n.add(e))}),{availableLabels:Array.from(t).sort().filter(e=>!d.includes(e)),availableIons:Array.from(n).sort().filter(e=>!h.includes(e))}},[n,y,d,h]);(0,s.useEffect)(()=>(document.body.style.overflow="auto",()=>{document.body.style.overflow=""}),[]),(0,s.useEffect)(()=>{(async()=>{const e=["/ionlandscape/data/people.json","/data/people.json","data/people.json"];for(const n of e)try{console.log("[Groups] Trying to fetch:",n);const e=await fetch(n);if(e.ok){const t=await e.json();return void a(t)}console.log("[Groups] Failed fetch (not ok):",n,e.status)}catch(t){console.log("[Groups] Error fetching:",n,t)}console.error("[Groups] All fetch attempts failed.")})()},[]);const A=(0,s.useMemo)(()=>n.length?n.filter(e=>{if("All"!==y){const t=(e.platforms||[]).some(e=>e.toLowerCase().includes("neutral"));if("Neutral Atoms"===y){if(!t)return!1}else if("Trapped Ions"===y&&t)return!1}if(u){const t=u.toLowerCase();if(!(e.name?.toLowerCase().includes(t)||e.sort_name?.toLowerCase().includes(t)))return!1}if(d.length>0){if(!d.every(t=>e.labels&&e.labels.includes(t)))return!1}if(h.length>0){if(!h.every(t=>e.ion_species&&e.ion_species.includes(t)))return!1}if(p.length>0){if(!p.every(t=>e.current_position?.institution===t))return!1}if(m.length>0){if(!m.every(t=>e.location?.country===t))return!1}return!0}):[],[n,u,d,h,p,m,y]),w=e=>{const n=new URLSearchParams;e.category&&"All"!==e.category&&n.set("category",e.category),e.q&&n.set("q",e.q),(e.label||[]).forEach(e=>n.append("label",e)),(e.ion||[]).forEach(e=>n.append("ion",e)),(e.inst||[]).forEach(e=>n.append("inst",e)),(e.country||[]).forEach(e=>n.append("country",e)),t.push({search:n.toString()})},_=(e,t)=>{const s={q:f,label:d,ion:h,inst:p,country:m};if("inst"===e){s.inst=[t];const e=n.find(e=>e.current_position?.institution===t);console.log("[Groups] Selected Inst:",t),console.log("[Groups] Found Person:",e?e.name:"None"),e?.location?.country&&(console.log("[Groups] Auto-setting Country:",e.location.country),s.country=[e.location.country])}else if("country"===e){if(s.country=[t],s.inst.length>0){const e=s.inst[0];n.some(n=>n.current_position?.institution===e&&n.location?.country===t)||(s.inst=[])}}else{if(s[e].includes(t))return;s[e]=[...s[e],t]}w(s)},k=(e,t)=>{const n={q:f,label:d,ion:h,inst:p,country:m};n[e]=n[e].filter(e=>e!==t),w(n)},E=u||d.length>0||h.length>0||p.length>0||m.length>0;return(0,i.jsx)(l.A,{title:"Groups",children:(0,i.jsxs)("div",{className:"groups-page container margin-vert--lg",children:[(0,i.jsx)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"1rem"},children:(0,i.jsx)("h1",{children:"Research Groups"})}),(0,i.jsx)("div",{style:{display:"flex",justifyContent:"center",marginBottom:"20px"},children:(0,i.jsx)("div",{className:"button-group",children:["All","Trapped Ions","Neutral Atoms"].map(e=>(0,i.jsx)("button",{className:"button button--"+(y===e?"primary":"secondary"),onClick:()=>x(e),style:{margin:"0 5px"},children:e},e))})}),(0,i.jsxs)("div",{className:"filter-bar",children:[(0,i.jsx)("div",{style:{marginBottom:"16px"},children:(0,i.jsx)("input",{id:"search-input",type:"text",className:"filter-select",style:{width:"100%",maxWidth:"400px",cursor:"text"},placeholder:"Search by name...",value:f,onChange:e=>g(e.target.value)})}),(0,i.jsxs)("div",{className:"filter-bar-row",children:[(0,i.jsxs)("select",{className:"filter-select",value:"",onChange:e=>e.target.value&&_("label",e.target.value),children:[(0,i.jsx)("option",{value:"",children:"+ Label"}),N.map(e=>(0,i.jsx)("option",{value:e,children:e},e))]}),"All"!==y&&(0,i.jsxs)("select",{className:"filter-select",value:"",onChange:e=>e.target.value&&_("ion",e.target.value),children:[(0,i.jsxs)("option",{value:"",children:["+ ","Neutral Atoms"===y?"Atom Species":"Ion Species"]}),C.map(e=>(0,i.jsx)("option",{value:e,children:e},e))]}),(0,i.jsxs)("select",{className:"filter-select",value:"",onChange:e=>e.target.value&&_("inst",e.target.value),children:[(0,i.jsx)("option",{value:"",children:"+ Institution"}),b.map(e=>(0,i.jsx)("option",{value:e,children:e},e))]}),(0,i.jsxs)("select",{className:"filter-select",value:"",onChange:e=>e.target.value&&_("country",e.target.value),children:[(0,i.jsx)("option",{value:"",children:"+ Country"}),j.map(e=>(0,i.jsx)("option",{value:e,children:e},e))]}),E&&(0,i.jsx)("button",{className:"clear-all-btn",onClick:()=>{g(""),t.push({search:""})},children:"Clear All"})]}),E&&(0,i.jsxs)("div",{className:"filter-chips",children:[d.map(e=>(0,i.jsxs)("span",{className:"filter-chip filter-chip--label",children:[e," ",(0,i.jsx)("button",{className:"filter-chip-remove",onClick:()=>k("label",e),children:"\xd7"})]},`label-${e}`)),h.map(e=>(0,i.jsxs)("span",{className:"filter-chip filter-chip--ion",children:[e," ",(0,i.jsx)("button",{className:"filter-chip-remove",onClick:()=>k("ion",e),children:"\xd7"})]},`ion-${e}`)),p.map(e=>(0,i.jsxs)("span",{className:"filter-chip",style:{background:"#e9ecef",color:"#333",border:"1px solid #ddd"},children:["\ud83c\udfdb\ufe0f ",e," ",(0,i.jsx)("button",{className:"filter-chip-remove",onClick:()=>k("inst",e),children:"\xd7"})]},`inst-${e}`)),m.map(e=>(0,i.jsxs)("span",{className:"filter-chip",style:{background:"#e9ecef",color:"#333",border:"1px solid #ddd"},children:["\ud83c\udf0d ",e," ",(0,i.jsx)("button",{className:"filter-chip-remove",onClick:()=>k("country",e),children:"\xd7"})]},`country-${e}`))]})]}),(0,i.jsxs)("p",{style:{color:"#666"},children:["Found ",A.length," researchers"]}),(0,i.jsxs)("div",{className:"row",children:[A.map(e=>(0,i.jsx)("div",{className:"col col--4 margin-bottom--lg",children:(0,i.jsxs)("div",{className:"card",children:[(0,i.jsx)("div",{className:"card__header",children:(0,i.jsx)("h3",{children:e.name})}),(0,i.jsxs)("div",{className:"card__body",children:[(0,i.jsx)("p",{children:e.current_position?.institution}),(0,i.jsx)("div",{style:{marginBottom:8},children:e.labels?.map(e=>(0,i.jsx)("span",{className:"badge badge--primary margin-right--xs",style:{cursor:"pointer"},onClick:()=>_("label",e),children:e},e))}),(0,i.jsx)("div",{children:e.ion_species?.map(e=>(0,i.jsx)("span",{className:"badge badge--secondary margin-right--xs",style:{cursor:"pointer"},onClick:()=>_("ion",e),children:e},e))})]}),(0,i.jsx)("div",{className:"card__footer",children:(0,i.jsx)(o.A,{to:`/?person=${e.id}`,className:"button button--primary button--block",children:"View on Map"})})]})},e.id)),0===A.length&&(0,i.jsx)("div",{className:"col col--12",children:(0,i.jsx)("div",{className:"alert alert--warning",children:(0,i.jsx)("p",{children:"No groups found matching criteria."})})})]})]})})}}}]);